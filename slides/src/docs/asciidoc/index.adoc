:muster: ../../../../hilla-todo-muster

[state=no-title-footer]
== Goldschmiede

[.text-center]
--

image:hilla.svg[width=600px]

29.04.2022, Hans Jörg Heßmann
--

[.columns]
== Vorstellung

--
[.heading]
Hans Jörg Heßmann

* Softwareentwickler
* Java seit 1997
* Schwerpunkte
** Webanwendungen
** Batch-Entwicklung
** Build und Deployment
** Codequalität und Testing
* Java, Spring, Vaadin, Asciidoc, Dessert, ...
--

image::anderScore/user-hjhessmann.jpg[float=right, pdfwidth=3cm]

include::anderScore1Slide.adoc[]

== Name: Hilla

image:translate_Hilla.png[width=80%]

[.columns]
== Wikipedia

image:wikipedia_Moltebeere.png[width=80%]

--
https://de.wikipedia.org/wiki/Moltebeere[https://de.wikipedia.org +
/wiki/Moltebeere]
--

== Vaadin

image:translate_Vaadin.png[width=80%]

== hilla.dev

image:hilla_dev.png[width=80%]

https://hilla.dev/

== Vergleich

https://vaadin.com/comparison?compare=hilla_vs_angular

== Getting Started

Projekt anlegen:

    npx @vaadin/cli init --hilla hilla-todo

-> https://hilla.dev/docs/getting-started

== Build

Bauen und starten mit:

    mvn clean install
    mvn spring-boot:run

== Backend-Dependencies hinzufügen

https://start.spring.io/

* Lombok
* Spring Data JPA
* HSQL
* Actuator

== New View anlegen

frontend/views/todo/todo-view.ts

[source, typescript]
----
@customElement('todo-view')
export class TodoView extends View {
  name = '';

  connectedCallback() {
    super.connectedCallback();
    this.classList.add('flex', 'p-m', 'gap-m', 'items-end');
  }

  render() {
    return html`
      <h1>Todo-Liste</h1>
    `;
  }
}
----

== View hinzufügen

frontend/routes.ts

[source, typescript]
----
import './views/todo/todo-view';
...
  {
    path: 'todo',
    component: 'todo-view',
    icon: '',
    title: 'Todo',
  },
...
----

== Backend: Entity

[source, java]
----
include::{muster}/src/main/java/com/example/application/repository/todo/TodoItem.java[tags=code]
----

== Backend: Repository

[source, java]
----
include::{muster}/src/main/java/com/example/application/repository/todo/TodoItemRepository.java[tags=code]
----

== Backend: Endpoint

[source, java]
----
include::{muster}/src/main/java/com/example/application/endpoints/todo/TodoEndpoint.java[tags=code]
----

== Einfaches Formular

[source, typescript]
----
import '@vaadin/button';
import '@vaadin/text-field';

...

  render() {
    return html`
      <h1>Todo-Liste</h1>
      <div>
        <vaadin-text-field label="Aufgabe"></vaadin-text-field>
        <vaadin-button>Hinzufügen</vaadin-button>
      </div>
    `;
  }
----

== Layout-Anpassungen

[source, typescript]
----
  connectedCallback() {
    super.connectedCallback();
    this.classList.add('flex', 'flex-col', 'p-m', 'gap-m', 'items-start');
  }
----

-> https://vaadin.com/docs/latest/ds/foundation/utility-classes

== Binding

[source, typescript]
----
import {Binder, field} from "@hilla/form";
import TodoItemModel from "Frontend/generated/com/example/application/repository/todo/TodoItemModel";

...

  binder = new Binder(this, TodoItemModel);

  render() {
    return html`
      <h1>Todo-Liste</h1>
      <div>
        <vaadin-text-field label="Aufgabe" ${field(this.binder.model.name)}></vaadin-text-field>
        <vaadin-button>Hinzufügen</vaadin-button>
      </div>
    `;
  }
----

== Binding

[source, typescript]
----
import {Binder, field} from "@hilla/form";
import TodoItemModel from "Frontend/generated/com/example/application/repository/todo/TodoItemModel";

...

  binder = new Binder(this, TodoItemModel);

  render() {
    return html`
      <h1>Todo-Liste</h1>
      <div>
        <vaadin-text-field label="Aufgabe" ${field(this.binder.model.name)}></vaadin-text-field>
        <vaadin-button>Hinzufügen</vaadin-button>
      </div>
    `;
  }
----

== Click-Handler

[source, typescript]
----
import {TodoEndpoint} from "Frontend/generated/endpoints";

...

  render() {
    return html`
      <h1>Todo-Liste</h1>
      <div>
        <vaadin-text-field label="Aufgabe" ${field(this.binder.model.name)}></vaadin-text-field>
        <vaadin-button @click="${this.addItem}">Hinzufügen</vaadin-button>
      </div>
    `;
  }

  async addItem() {
    const savedItem = await this.binder.submitTo(TodoEndpoint.saveItem);
    if (savedItem) {
      console.log("created item with id " + savedItem.id);
      this.binder.clear();
    }
  }
----

== Liste anzeigen

[source, typescript]
----
    @state()
    private items: TodoItem[] = [];

    async connectedCallback() {
        super.connectedCallback();
        this.items = await TodoEndpoint.findAll();
        this.classList.add('flex', 'flex-col', 'p-m', 'gap-m', 'items-start');
    }

    render() {
        return html`
            <h1>Todo-Liste</h1>
            <div>
                ${this.items.map(item => html`
                    <div class="todo-item">${item.name}</div>
                `)}
            </div>
            <div>
                <vaadin-text-field label="Aufgabe" ${field(this.binder.model.name)}></vaadin-text-field>
                <vaadin-button @click="${this.addItem}">Hinzufügen</vaadin-button>
            </div>
        `;
    }
----

== Styling

frontend/themes/hilla-todo-muster/styles.css

[source, typescript]
----
todo-view .todo-item {
    min-width: 20em;
    background-color: lightgreen;
}
----

== Vertiefung

* Ausführliches Tutorial: https://hilla.dev/docs/tutorials/in-depth-course
